<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Security Operations Center | ANGELSUCCESS AI Cybersecurity</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/luxon@3.0.4/build/global/luxon.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chartjs-adapter-luxon@1.3.1/dist/chartjs-adapter-luxon.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        :root {
            --primary: #2563eb;
            --primary-light: #3b82f6;
            --primary-dark: #1e40af;
            --secondary: #7c3aed;
            --danger: #dc2626;
            --danger-light: #ef4444;
            --warning: #d97706;
            --warning-light: #f59e0b;
            --success: #059669;
            --success-light: #10b981;
            --info: #0891b2;
            --info-light: #06b6d4;
            --cyber-blue: #00d9ff;
            --cyber-green: #00ff88;
            --dark: #1f2937;
            --dark-light: #374151;
            --darker: #0f172a;
            --text-light: #e5e7eb;
            --text-muted: #9ca3af;
            --card-bg: rgba(30, 41, 59, 0.8);
            --card-border: rgba(51, 65, 85, 0.5);
            --transition: all 0.3s ease;
            --shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
            --shadow-lg: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
            --glow: 0 0 20px rgba(59, 130, 246, 0.3);
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, var(--darker), #1a2332);
            color: var(--text-light);
            min-height: 100vh;
            line-height: 1.6;
            overflow-x: hidden;
        }

        /* Animated Background */
        .cyber-bg {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: -1;
            opacity: 0.1;
            background: 
                radial-gradient(circle at 20% 80%, rgba(59, 130, 246, 0.1) 0%, transparent 50%),
                radial-gradient(circle at 80% 20%, rgba(16, 185, 129, 0.1) 0%, transparent 50%);
        }

        .grid-pattern {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-image: 
                linear-gradient(rgba(59, 130, 246, 0.1) 1px, transparent 1px),
                linear-gradient(90deg, rgba(59, 130, 246, 0.1) 1px, transparent 1px);
            background-size: 50px 50px;
            z-index: -1;
            opacity: 0.3;
        }
        
        .navbar {
            background: rgba(30, 41, 59, 0.95);
            backdrop-filter: blur(20px);
            padding: 1rem 2rem;
            border-bottom: 1px solid rgba(59, 130, 246, 0.2);
            position: sticky;
            top: 0;
            z-index: 100;
            box-shadow: var(--shadow);
        }
        
        .nav-content {
            display: flex;
            justify-content: space-between;
            align-items: center;
            max-width: 1400px;
            margin: 0 auto;
        }
        
        .logo {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            font-size: 1.5rem;
            font-weight: bold;
        }
        
        .logo i {
            font-size: 1.8rem;
            color: var(--cyber-blue);
            text-shadow: 0 0 10px rgba(0, 217, 255, 0.5);
        }
        
        .logo span {
            background: linear-gradient(135deg, var(--cyber-blue), var(--cyber-green));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }
        
        .nav-links {
            display: flex;
            gap: 1.5rem;
            list-style: none;
        }
        
        .nav-links a {
            color: #cbd5e1;
            text-decoration: none;
            transition: var(--transition);
            display: flex;
            align-items: center;
            gap: 0.5rem;
            padding: 0.5rem 1rem;
            border-radius: 6px;
            font-weight: 500;
            position: relative;
        }
        
        .nav-links a:hover {
            color: var(--cyber-blue);
            background: rgba(96, 165, 250, 0.1);
        }
        
        .nav-links a.active {
            color: var(--cyber-blue);
            background: rgba(96, 165, 250, 0.15);
        }
        
        .nav-links a.active::after {
            content: '';
            position: absolute;
            bottom: -1px;
            left: 1rem;
            right: 1rem;
            height: 2px;
            background: var(--cyber-blue);
            border-radius: 1px;
        }
        
        .main-container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 2rem;
        }
        
        .dashboard-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 2rem;
        }
        
        .page-title {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            font-size: 1.75rem;
        }
        
        .status-indicator {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            font-size: 0.9rem;
            color: var(--success);
            background: rgba(5, 150, 105, 0.2);
            padding: 0.25rem 0.75rem;
            border-radius: 20px;
            border: 1px solid rgba(5, 150, 105, 0.3);
        }
        
        .header-actions {
            display: flex;
            gap: 1rem;
        }
        
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 1.5rem;
            margin-bottom: 2rem;
        }
        
        .stat-card {
            background: var(--card-bg);
            border: 1px solid var(--card-border);
            border-radius: 12px;
            padding: 1.5rem;
            backdrop-filter: blur(20px);
            transition: var(--transition);
            position: relative;
            overflow: hidden;
        }
        
        .stat-card:hover {
            transform: translateY(-5px);
            box-shadow: var(--shadow-lg);
            border-color: rgba(59, 130, 246, 0.3);
        }
        
        .stat-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 4px;
        }
        
        .stat-card.critical::before {
            background: var(--danger);
        }
        
        .stat-card.warning::before {
            background: var(--warning);
        }
        
        .stat-card.success::before {
            background: var(--success);
        }
        
        .stat-card.primary::before {
            background: var(--primary);
        }
        
        .stat-card.info::before {
            background: var(--info);
        }
        
        .stat-card.secondary::before {
            background: var(--secondary);
        }
        
        .stat-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 0.75rem;
        }
        
        .stat-title {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            font-size: 1rem;
            font-weight: 500;
        }
        
        .stat-icon {
            font-size: 1.25rem;
            opacity: 0.8;
        }
        
        .stat-value {
            font-size: 2.5rem;
            font-weight: bold;
            margin: 0.5rem 0;
            background: linear-gradient(90deg, var(--cyber-blue), var(--cyber-green));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }
        
        .stat-description {
            font-size: 0.9rem;
            color: var(--text-muted);
            margin-bottom: 0.5rem;
        }
        
        .stat-trend {
            display: flex;
            align-items: center;
            gap: 0.25rem;
            font-size: 0.85rem;
            font-weight: 500;
            padding: 0.25rem 0.5rem;
            border-radius: 12px;
            background: rgba(255, 255, 255, 0.05);
        }
        
        .trend-up {
            color: var(--success);
        }
        
        .trend-down {
            color: var(--danger);
        }
        
        .charts-container {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 1.5rem;
            margin-bottom: 2rem;
        }
        
        .chart-card {
            background: var(--card-bg);
            border: 1px solid var(--card-border);
            border-radius: 12px;
            padding: 1.5rem;
            backdrop-filter: blur(20px);
            transition: var(--transition);
            height: 300px;
        }
        
        .chart-card:hover {
            box-shadow: var(--shadow);
            border-color: rgba(59, 130, 246, 0.2);
        }
        
        .chart-card.full-width {
            grid-column: 1 / -1;
            height: 350px;
        }
        
        .chart-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1rem;
        }
        
        .chart-title {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            font-size: 1.2rem;
            font-weight: 600;
        }
        
        .chart-icon {
            font-size: 1.1rem;
            opacity: 0.8;
            color: var(--cyber-blue);
        }
        
        .chart-status {
            font-size: 0.85rem;
            color: var(--text-muted);
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }
        
        .chart-status::before {
            content: '';
            width: 6px;
            height: 6px;
            border-radius: 50%;
            background: var(--success);
            display: inline-block;
            animation: pulse 2s infinite;
        }
        
        .threat-feed {
            background: var(--card-bg);
            border: 1px solid var(--card-border);
            border-radius: 12px;
            padding: 1.5rem;
            backdrop-filter: blur(20px);
            max-height: 500px;
            overflow-y: auto;
            transition: var(--transition);
        }
        
        .threat-feed:hover {
            box-shadow: var(--shadow);
        }
        
        .threat-item {
            padding: 1rem;
            border-left: 4px solid;
            margin-bottom: 0.75rem;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 0 8px 8px 0;
            transition: var(--transition);
            position: relative;
            overflow: hidden;
        }
        
        .threat-item::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.1), transparent);
            transition: left 0.6s;
        }
        
        .threat-item:hover::before {
            left: 100%;
        }
        
        .threat-item:hover {
            background: rgba(255, 255, 255, 0.08);
            transform: translateX(5px);
        }
        
        .threat-item.critical { 
            border-left-color: var(--danger); 
            background: rgba(220, 38, 38, 0.1); 
        }
        
        .threat-item.high { 
            border-left-color: var(--warning); 
            background: rgba(217, 119, 6, 0.1); 
        }
        
        .threat-item.medium { 
            border-left-color: var(--primary); 
            background: rgba(37, 99, 235, 0.1); 
        }
        
        .threat-item.low { 
            border-left-color: var(--success); 
            background: rgba(5, 150, 105, 0.1); 
        }
        
        .threat-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 0.5rem;
        }
        
        .threat-title {
            font-weight: 600;
            font-size: 1.05rem;
        }
        
        .threat-time {
            font-size: 0.8rem;
            color: var(--text-muted);
        }
        
        .threat-details {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 0.75rem;
            font-size: 0.85rem;
        }
        
        .threat-detail {
            display: flex;
            flex-direction: column;
            gap: 0.25rem;
        }
        
        .detail-label {
            color: var(--text-muted);
            font-size: 0.8rem;
        }
        
        .detail-value {
            font-weight: 500;
        }
        
        .btn {
            padding: 0.75rem 1.5rem;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 500;
            transition: var(--transition);
            display: flex;
            align-items: center;
            gap: 0.5rem;
            font-size: 0.95rem;
            position: relative;
            overflow: hidden;
        }
        
        .btn::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.2), transparent);
            transition: left 0.5s;
        }
        
        .btn:hover::before {
            left: 100%;
        }
        
        .btn:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow);
        }
        
        .btn-primary {
            background: linear-gradient(135deg, var(--primary), var(--primary-light));
            color: white;
        }
        
        .btn-primary:hover {
            background: linear-gradient(135deg, var(--primary-light), var(--primary));
        }
        
        .btn-danger {
            background: linear-gradient(135deg, var(--danger), var(--danger-light));
            color: white;
        }
        
        .btn-danger:hover {
            background: linear-gradient(135deg, var(--danger-light), var(--danger));
        }
        
        .btn-success {
            background: linear-gradient(135deg, var(--success), var(--success-light));
            color: white;
        }
        
        .btn-success:hover {
            background: linear-gradient(135deg, var(--success-light), var(--success));
        }
        
        .btn-warning {
            background: linear-gradient(135deg, var(--warning), var(--warning-light));
            color: white;
        }
        
        .btn-warning:hover {
            background: linear-gradient(135deg, var(--warning-light), var(--warning));
        }
        
        .btn-outline {
            background: transparent;
            border: 1px solid var(--primary);
            color: var(--primary);
        }
        
        .btn-outline:hover {
            background: rgba(37, 99, 235, 0.1);
        }
        
        .global-threat-map {
            height: 250px;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 8px;
            position: relative;
            overflow: hidden;
            background-image: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 800 400" fill="%23374151"><path d="M100,100 Q400,50 700,100 L700,300 Q400,350 100,300 Z"/></svg>');
            background-size: cover;
        }
        
        .map-point {
            position: absolute;
            width: 12px;
            height: 12px;
            border-radius: 50%;
            transform: translate(-50%, -50%);
            animation: pulse 2s infinite;
            cursor: pointer;
            z-index: 2;
        }
        
        .map-point.critical {
            background: var(--danger);
            box-shadow: 0 0 0 0 rgba(220, 38, 38, 0.7);
        }
        
        .map-point.high {
            background: var(--warning);
            box-shadow: 0 0 0 0 rgba(217, 119, 6, 0.7);
        }
        
        .map-point.medium {
            background: var(--primary);
            box-shadow: 0 0 0 0 rgba(37, 99, 235, 0.7);
        }
        
        @keyframes pulse {
            0% {
                transform: translate(-50%, -50%) scale(0.95);
                box-shadow: 0 0 0 0 rgba(220, 38, 38, 0.7);
            }
            
            70% {
                transform: translate(-50%, -50%) scale(1);
                box-shadow: 0 0 0 10px rgba(220, 38, 38, 0);
            }
            
            100% {
                transform: translate(-50%, -50%) scale(0.95);
                box-shadow: 0 0 0 0 rgba(220, 38, 38, 0);
            }
        }
        
        .map-legend {
            position: absolute;
            bottom: 1rem;
            right: 1rem;
            background: rgba(30, 41, 59, 0.9);
            border-radius: 8px;
            padding: 0.75rem;
            font-size: 0.8rem;
            border: 1px solid var(--card-border);
            z-index: 3;
        }
        
        .legend-item {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            margin-bottom: 0.25rem;
        }
        
        .legend-color {
            width: 10px;
            height: 10px;
            border-radius: 50%;
        }
        
        .legend-color.critical {
            background: var(--danger);
        }
        
        .legend-color.high {
            background: var(--warning);
        }
        
        .legend-color.medium {
            background: var(--primary);
        }
        
        .refresh-indicator {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            color: var(--text-muted);
            font-size: 0.9rem;
            margin-top: 1rem;
        }
        
        .pulse {
            display: inline-block;
            width: 8px;
            height: 8px;
            border-radius: 50%;
            background: var(--success);
            animation: pulse 2s infinite;
        }
        
        /* Enhanced Security Badges */
        .security-badge {
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            padding: 0.25rem 0.75rem;
            border-radius: 20px;
            font-size: 0.8rem;
            font-weight: 500;
        }
        
        .badge-success {
            background: rgba(5, 150, 105, 0.2);
            color: var(--success);
            border: 1px solid rgba(5, 150, 105, 0.3);
        }
        
        .badge-warning {
            background: rgba(217, 119, 6, 0.2);
            color: var(--warning);
            border: 1px solid rgba(217, 119, 6, 0.3);
        }
        
        .badge-danger {
            background: rgba(220, 38, 38, 0.2);
            color: var(--danger);
            border: 1px solid rgba(220, 38, 38, 0.3);
        }
        
        /* Enhanced Tooltip */
        .tooltip {
            position: absolute;
            background: rgba(30, 41, 59, 0.95);
            border: 1px solid var(--card-border);
            border-radius: 8px;
            padding: 0.75rem;
            font-size: 0.8rem;
            z-index: 1000;
            pointer-events: none;
            opacity: 0;
            transition: opacity 0.3s;
            backdrop-filter: blur(10px);
            max-width: 250px;
        }
        
        /* Notification System */
        .security-notification {
            position: fixed;
            top: 20px;
            right: 20px;
            padding: 1rem 1.5rem;
            border-radius: 8px;
            color: white;
            font-weight: 500;
            z-index: 1000;
            border: 1px solid;
            box-shadow: var(--shadow-lg);
            transform: translateX(100%);
            transition: transform 0.3s ease;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }
        
        .security-notification.success {
            background: var(--success);
            border-color: var(--success-light);
        }
        
        .security-notification.error {
            background: var(--danger);
            border-color: var(--danger-light);
        }
        
        .security-notification.warning {
            background: var(--warning);
            border-color: var(--warning-light);
        }
        
        /* Network Devices Panel */
        .network-devices {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1rem;
            margin-top: 1rem;
        }
        
        .device-card {
            background: rgba(255, 255, 255, 0.05);
            padding: 1rem;
            border-radius: 8px;
            border-left: 4px solid var(--success);
        }
        
        .device-card.offline {
            border-left-color: var(--danger);
            opacity: 0.7;
        }
        
        /* Responsive adjustments */
        @media (max-width: 1024px) {
            .charts-container {
                grid-template-columns: 1fr;
            }
            
            .chart-card.full-width {
                grid-column: 1;
            }
        }
        
        @media (max-width: 768px) {
            .navbar {
                padding: 1rem;
            }
            
            .nav-content {
                flex-direction: column;
                gap: 1rem;
            }
            
            .nav-links {
                gap: 1rem;
                flex-wrap: wrap;
                justify-content: center;
            }
            
            .main-container {
                padding: 1rem;
            }
            
            .dashboard-header {
                flex-direction: column;
                align-items: flex-start;
                gap: 1rem;
            }
            
            .header-actions {
                width: 100%;
                justify-content: space-between;
            }
            
            .stats-grid {
                grid-template-columns: repeat(2, 1fr);
            }
            
            .threat-details {
                grid-template-columns: 1fr;
            }
        }
        
        @media (max-width: 480px) {
            .stats-grid {
                grid-template-columns: 1fr;
            }
            
            .header-actions {
                flex-direction: column;
                gap: 0.5rem;
            }
            
            .btn {
                width: 100%;
                justify-content: center;
            }
        }
    </style>
</head>
<body>
    <!-- Animated Background -->
    <div class="cyber-bg"></div>
    <div class="grid-pattern"></div>

    <nav class="navbar">
        <div class="nav-content">
            <div class="logo">
                <i class="fas fa-shield-alt"></i>
                <span>ANGELSUCCESS SOC</span>
            </div>
            <ul class="nav-links">
                <li><a href="/soc-dashboard" class="active"><i class="fas fa-tachometer-alt"></i> Security Dashboard</a></li>
                <li><a href="/network-monitor"><i class="fas fa-network-wired"></i> Network Monitor</a></li>
                <li><a href="/ai-analysis"><i class="fas fa-robot"></i> AI Analysis</a></li>
                <li><a href="/threat-intelligence"><i class="fas fa-bug"></i> Threat Intel</a></li>
                <li><a href="/optimization-center"><i class="fas fa-cogs"></i> Optimization</a></li>
                <li><a href="/system-settings"><i class="fas fa-sliders-h"></i> Settings</a></li>
                <li><a href="#" onclick="logout()"><i class="fas fa-sign-out-alt"></i> Secure Logout</a></li>
            </ul>
        </div>
    </nav>

    <div class="main-container">
        <div class="dashboard-header">
            <h1 class="page-title">
                <i class="fas fa-shield-alt"></i>
                Security Operations Center
                <span class="status-indicator">
                    <i class="fas fa-circle"></i>
                    LIVE MONITORING
                </span>
            </h1>
            <div class="header-actions">
                <button class="btn btn-success" onclick="startAITraining()">
                    <i class="fas fa-rocket"></i> Train AI Models
                </button>
                <button class="btn btn-warning" onclick="optimizeSystem()">
                    <i class="fas fa-bolt"></i> Optimize System
                </button>
                <button class="btn btn-danger" onclick="clearThreats()">
                    <i class="fas fa-trash"></i> Clear Threats
                </button>
                <button class="btn btn-primary" onclick="scanNetwork()">
                    <i class="fas fa-search"></i> Scan Network
                </button>
            </div>
        </div>

        <!-- Enhanced Stats Grid -->
        <div class="stats-grid">
            <div class="stat-card critical">
                <div class="stat-header">
                    <div class="stat-title">
                        <i class="fas fa-exclamation-triangle stat-icon"></i>
                        Active Threats
                    </div>
                    <div class="stat-trend trend-up" id="threatTrend">
                        <i class="fas fa-arrow-up"></i> 0%
                    </div>
                </div>
                <div class="stat-value" id="activeThreats">0</div>
                <div class="stat-description">Real-time detected threats</div>
                <div class="security-badge badge-danger">
                    <i class="fas fa-shield-alt"></i> CRITICAL
                </div>
            </div>
            
            <div class="stat-card warning">
                <div class="stat-header">
                    <div class="stat-title">
                        <i class="fas fa-brain stat-icon"></i>
                        AI Confidence
                    </div>
                    <div class="stat-trend trend-up" id="confidenceTrend">
                        <i class="fas fa-arrow-up"></i> 0%
                    </div>
                </div>
                <div class="stat-value" id="aiConfidence">0%</div>
                <div class="stat-description">Threat detection accuracy</div>
                <div class="security-badge badge-warning">
                    <i class="fas fa-robot"></i> AI POWERED
                </div>
            </div>
            
            <div class="stat-card success">
                <div class="stat-header">
                    <div class="stat-title">
                        <i class="fas fa-heartbeat stat-icon"></i>
                        System Health
                    </div>
                    <div class="stat-trend trend-up" id="healthTrend">
                        <i class="fas fa-arrow-up"></i> 0%
                    </div>
                </div>
                <div class="stat-value" id="systemHealth">0%</div>
                <div class="stat-description">Overall system performance</div>
                <div class="security-badge badge-success">
                    <i class="fas fa-check-circle"></i> OPTIMAL
                </div>
            </div>
            
            <div class="stat-card primary">
                <div class="stat-header">
                    <div class="stat-title">
                        <i class="fas fa-shield-alt stat-icon"></i>
                        Prevention Rate
                    </div>
                    <div class="stat-trend trend-up" id="preventionTrend">
                        <i class="fas fa-arrow-up"></i> 0%
                    </div>
                </div>
                <div class="stat-value" id="preventionRate">0%</div>
                <div class="stat-description">Successful threat prevention</div>
            </div>
            
            <div class="stat-card info">
                <div class="stat-header">
                    <div class="stat-title">
                        <i class="fas fa-cogs stat-icon"></i>
                        Optimization
                    </div>
                    <div class="stat-trend trend-up" id="optimizationTrend">
                        <i class="fas fa-arrow-up"></i> 0%
                    </div>
                </div>
                <div class="stat-value" id="optimizationScore">0%</div>
                <div class="stat-description">System optimization level</div>
            </div>
            
            <div class="stat-card secondary">
                <div class="stat-header">
                    <div class="stat-title">
                        <i class="fas fa-tachometer-alt stat-icon"></i>
                        Performance
                    </div>
                    <div class="stat-trend trend-up" id="performanceTrend">
                        <i class="fas fa-arrow-up"></i> 0%
                    </div>
                </div>
                <div class="stat-value" id="performanceBoost">0%</div>
                <div class="stat-description">AI-enhanced performance</div>
            </div>
        </div>

        <!-- Multiple Charts Section -->
        <div class="charts-container">
            <!-- Threat Timeline Chart -->
            <div class="chart-card">
                <div class="chart-header">
                    <h3 class="chart-title">
                        <i class="fas fa-chart-line chart-icon"></i>
                        Threat Timeline (24h)
                    </h3>
                    <span class="chart-status" id="timelineUpdate">Live</span>
                </div>
                <canvas id="threatTimelineChart"></canvas>
            </div>

            <!-- Threat Distribution Pie Chart -->
            <div class="chart-card">
                <div class="chart-header">
                    <h3 class="chart-title">
                        <i class="fas fa-chart-pie chart-icon"></i>
                        Threat Distribution
                    </h3>
                    <span class="chart-status">Real-time</span>
                </div>
                <canvas id="threatDistributionChart"></canvas>
            </div>

            <!-- System Performance Chart -->
            <div class="chart-card">
                <div class="chart-header">
                    <h3 class="chart-title">
                        <i class="fas fa-desktop chart-icon"></i>
                        System Performance
                    </h3>
                    <span class="chart-status">Live Metrics</span>
                </div>
                <canvas id="systemPerformanceChart"></canvas>
            </div>

            <!-- AI Models Comparison -->
            <div class="chart-card">
                <div class="chart-header">
                    <h3 class="chart-title">
                        <i class="fas fa-robot chart-icon"></i>
                        AI Models Accuracy
                    </h3>
                    <span class="chart-status">Ensemble Lead</span>
                </div>
                <canvas id="aiModelsChart"></canvas>
            </div>

            <!-- Network Flow Chart -->
            <div class="chart-card full-width">
                <div class="chart-header">
                    <h3 class="chart-title">
                        <i class="fas fa-network-wired chart-icon"></i>
                        Network Traffic Flow
                    </h3>
                    <span class="chart-status" id="networkUpdate">Active</span>
                </div>
                <canvas id="networkFlowChart"></canvas>
            </div>

            <!-- Global Threat Map -->
            <div class="chart-card full-width">
                <div class="chart-header">
                    <h3 class="chart-title">
                        <i class="fas fa-globe-americas chart-icon"></i>
                        Global Threat Activity
                    </h3>
                    <span class="chart-status">Live Feed</span>
                </div>
                <div class="global-threat-map" id="globalThreatMap">
                    <!-- Map points will be dynamically added here -->
                    <div class="map-legend">
                        <div class="legend-item">
                            <div class="legend-color critical"></div>
                            <span>Critical</span>
                        </div>
                        <div class="legend-item">
                            <div class="legend-color high"></div>
                            <span>High</span>
                        </div>
                        <div class="legend-item">
                            <div class="legend-color medium"></div>
                            <span>Medium</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Real-time Threat Feed -->
        <div class="threat-feed">
            <div class="chart-header">
                <h3 class="chart-title">
                    <i class="fas fa-list-alt chart-icon"></i>
                    Real-time Threat Feed
                </h3>
                <span class="chart-status" id="threatCount">0 threats</span>
            </div>
            <div id="threatFeed">
                <p>Loading real-time threat data...</p>
            </div>
            <div class="refresh-indicator">
                <span class="pulse"></span>
                <span>Live data updating every 2 seconds</span>
            </div>
        </div>
    </div>

    <script>
        // Enhanced dashboard functionality with real-time features
        class SecurityDashboard {
            constructor() {
                this.charts = {};
                this.previousData = {};
                this.threatPoints = [];
                this.updateInterval = null;
                this.isInitialized = false;
                this.currentTooltip = null;
            }

            initialize() {
                this.initializeCharts();
                this.setupEventListeners();
                this.startRealTimeUpdates();
                this.isInitialized = true;
                console.log('🔒 Security Dashboard Initialized');
            }

            initializeCharts() {
                // Threat Timeline Chart
                const threatCtx = document.getElementById('threatTimelineChart').getContext('2d');
                this.charts.threatTimeline = new Chart(threatCtx, {
                    type: 'line',
                    data: {
                        labels: Array.from({length: 24}, (_, i) => `${i}:00`),
                        datasets: [
                            {
                                label: 'Threats Detected',
                                data: Array(24).fill(0),
                                borderColor: '#dc2626',
                                backgroundColor: 'rgba(220, 38, 38, 0.1)',
                                borderWidth: 3,
                                tension: 0.4,
                                fill: true,
                                pointBackgroundColor: '#dc2626',
                                pointBorderColor: '#ffffff',
                                pointBorderWidth: 2,
                                pointRadius: 4
                            }
                        ]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        plugins: {
                            legend: {
                                position: 'top',
                                labels: { color: '#e5e7eb', usePointStyle: true, padding: 15 }
                            },
                            tooltip: {
                                backgroundColor: 'rgba(30, 41, 59, 0.95)',
                                titleColor: '#e5e7eb',
                                bodyColor: '#e5e7eb',
                                borderColor: 'rgba(59, 130, 246, 0.3)',
                                borderWidth: 1
                            }
                        },
                        scales: {
                            y: {
                                beginAtZero: true,
                                grid: { color: 'rgba(255, 255, 255, 0.1)' },
                                ticks: { color: '#9ca3af' }
                            },
                            x: {
                                grid: { color: 'rgba(255, 255, 255, 0.1)' },
                                ticks: { color: '#9ca3af' }
                            }
                        }
                    }
                });

                // Threat Distribution Pie Chart
                const distributionCtx = document.getElementById('threatDistributionChart').getContext('2d');
                this.charts.threatDistribution = new Chart(distributionCtx, {
                    type: 'doughnut',
                    data: {
                        labels: ['Malware', 'Phishing', 'DDoS', 'Insider', 'Exploits'],
                        datasets: [{
                            data: [25, 20, 15, 10, 30],
                            backgroundColor: [
                                '#dc2626', '#d97706', '#2563eb', '#7c3aed', '#059669'
                            ],
                            borderColor: '#1f2937',
                            borderWidth: 2
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        plugins: {
                            legend: {
                                position: 'bottom',
                                labels: { color: '#e5e7eb', padding: 15 }
                            }
                        }
                    }
                });

                // System Performance Chart
                const performanceCtx = document.getElementById('systemPerformanceChart').getContext('2d');
                this.charts.performance = new Chart(performanceCtx, {
                    type: 'radar',
                    data: {
                        labels: ['CPU', 'Memory', 'Network', 'Storage', 'Security', 'AI'],
                        datasets: [{
                            label: 'Performance',
                            data: [85, 90, 78, 92, 88, 95],
                            backgroundColor: 'rgba(59, 130, 246, 0.2)',
                            borderColor: '#3b82f6',
                            borderWidth: 2,
                            pointBackgroundColor: '#3b82f6',
                            pointBorderColor: '#ffffff',
                            pointBorderWidth: 2
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        scales: {
                            r: {
                                angleLines: { color: 'rgba(255, 255, 255, 0.1)' },
                                grid: { color: 'rgba(255, 255, 255, 0.1)' },
                                pointLabels: { color: '#e5e7eb' },
                                ticks: { 
                                    backdropColor: 'transparent',
                                    color: '#9ca3af'
                                }
                            }
                        },
                        plugins: {
                            legend: { display: false }
                        }
                    }
                });

                // AI Models Comparison Chart
                const aiCtx = document.getElementById('aiModelsChart').getContext('2d');
                this.charts.aiModels = new Chart(aiCtx, {
                    type: 'bar',
                    data: {
                        labels: ['Supervised', 'Unsupervised', 'Ensemble'],
                        datasets: [{
                            label: 'Accuracy %',
                            data: [94, 89, 97],
                            backgroundColor: [
                                'rgba(37, 99, 235, 0.8)',
                                'rgba(124, 58, 237, 0.8)',
                                'rgba(5, 150, 105, 0.8)'
                            ],
                            borderColor: [
                                '#2563eb',
                                '#7c3aed',
                                '#059669'
                            ],
                            borderWidth: 2,
                            borderRadius: 6
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        plugins: {
                            legend: { display: false }
                        },
                        scales: {
                            y: {
                                beginAtZero: true,
                                max: 100,
                                grid: { color: 'rgba(255, 255, 255, 0.1)' },
                                ticks: { color: '#9ca3af' }
                            },
                            x: {
                                grid: { color: 'rgba(255, 255, 255, 0.1)' },
                                ticks: { color: '#e5e7eb' }
                            }
                        }
                    }
                });

                // Network Flow Chart
                const networkCtx = document.getElementById('networkFlowChart').getContext('2d');
                this.charts.networkFlow = new Chart(networkCtx, {
                    type: 'line',
                    data: {
                        labels: Array.from({length: 12}, (_, i) => `${i*2}s`),
                        datasets: [
                            {
                                label: 'Upload (KB/s)',
                                data: Array(12).fill(0),
                                borderColor: '#3b82f6',
                                backgroundColor: 'rgba(59, 130, 246, 0.1)',
                                borderWidth: 2,
                                tension: 0.4,
                                fill: true
                            },
                            {
                                label: 'Download (KB/s)',
                                data: Array(12).fill(0),
                                borderColor: '#10b981',
                                backgroundColor: 'rgba(16, 185, 129, 0.1)',
                                borderWidth: 2,
                                tension: 0.4,
                                fill: true
                            }
                        ]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        plugins: {
                            legend: {
                                position: 'top',
                                labels: { color: '#e5e7eb' }
                            }
                        },
                        scales: {
                            y: {
                                beginAtZero: true,
                                grid: { color: 'rgba(255, 255, 255, 0.1)' },
                                ticks: { color: '#9ca3af' }
                            },
                            x: {
                                grid: { color: 'rgba(255, 255, 255, 0.1)' },
                                ticks: { color: '#9ca3af' }
                            }
                        }
                    }
                });
            }

            setupEventListeners() {
                // Add click handlers for map points
                document.getElementById('globalThreatMap').addEventListener('click', (e) => {
                    if (e.target.classList.contains('map-point')) {
                        this.showThreatDetails(e.target.threatData);
                    }
                });

                // Add keyboard shortcuts
                document.addEventListener('keydown', (e) => {
                    if (e.ctrlKey || e.metaKey) {
                        switch(e.key) {
                            case 'r':
                                e.preventDefault();
                                this.fetchRealTimeData();
                                break;
                            case 't':
                                e.preventDefault();
                                this.startAITraining();
                                break;
                            case 'o':
                                e.preventDefault();
                                this.optimizeSystem();
                                break;
                        }
                    }
                });

                // Handle window resize for charts
                window.addEventListener('resize', () => {
                    Object.values(this.charts).forEach(chart => {
                        chart.resize();
                    });
                });
            }

            startRealTimeUpdates() {
                this.fetchRealTimeData();
                this.updateInterval = setInterval(() => {
                    this.fetchRealTimeData();
                }, 2000);
            }

            async fetchRealTimeData() {
                try {
                    const response = await fetch('/api/realtime-data');
                    if (!response.ok) throw new Error('Network response was not ok');
                    
                    const data = await response.json();
                    this.updateDashboard(data);
                } catch (error) {
                    console.error('Error fetching real-time data:', error);
                    // Fallback to mock data for demo
                    this.updateDashboard(this.generateMockData());
                }
            }

            updateDashboard(data) {
                // Enhanced update logic with animations
                this.animateValue('activeThreats', data.active_incidents || 0);
                this.animateValue('aiConfidence', data.ai_confidence || 0, '%');
                this.animateValue('systemHealth', data.system_health || 0, '%');
                this.animateValue('preventionRate', data.threat_prevention_rate || 0, '%');
                this.animateValue('optimizationScore', data.optimization_score || 0, '%');
                this.animateValue('performanceBoost', data.performance_boost || 0, '%');

                // Update trends
                this.updateTrends(data);

                // Update charts
                this.updateCharts(data);

                // Update threat feed and map
                this.updateThreatFeed(data.threat_feed || []);
                this.updateGlobalThreatMap(data.threat_feed || []);

                // Update counters and timestamps
                this.updateUIElements(data);
            }

            animateValue(elementId, targetValue, suffix = '') {
                const element = document.getElementById(elementId);
                const currentValue = parseInt(element.textContent) || 0;
                
                // Only animate if value changed significantly
                if (Math.abs(targetValue - currentValue) < 0.5 && currentValue !== 0) {
                    element.textContent = targetValue + suffix;
                    return;
                }

                const duration = 1000;
                const stepTime = 20;
                const steps = duration / stepTime;
                const increment = (targetValue - currentValue) / steps;
                let currentStep = 0;

                const timer = setInterval(() => {
                    currentStep++;
                    const value = Math.round(currentValue + (increment * currentStep));
                    element.textContent = value + suffix;

                    if (currentStep >= steps) {
                        element.textContent = targetValue + suffix;
                        clearInterval(timer);
                    }
                }, stepTime);
            }

            updateCharts(data) {
                // Update threat timeline with real data
                if (data.charts && data.charts.timeline) {
                    this.charts.threatTimeline.data.datasets[0].data = data.charts.timeline.threats;
                    this.charts.threatTimeline.update('none');
                }

                // Update threat distribution
                if (data.charts && data.charts.threat_categories) {
                    this.charts.threatDistribution.data.datasets[0].data = data.charts.threat_categories;
                    this.charts.threatDistribution.update('none');
                }

                // Update system performance
                if (data.charts && data.charts.performance) {
                    this.charts.performance.data.datasets[0].data = data.charts.performance;
                    this.charts.performance.update('none');
                }

                // Update AI models
                if (data.charts && data.charts.ai_models_comparison) {
                    this.charts.aiModels.data.datasets[0].data = data.charts.ai_models_comparison;
                    this.charts.aiModels.update('none');
                }

                // Update network flow with real data
                if (data.real_network_stats) {
                    const networkData = data.network_metrics || [];
                    const uploadSpeeds = networkData.slice(-12).map(d => (d.bytes_sent_per_sec / 1024).toFixed(2));
                    const downloadSpeeds = networkData.slice(-12).map(d => (d.bytes_recv_per_sec / 1024).toFixed(2));
                    
                    this.charts.networkFlow.data.datasets[0].data = uploadSpeeds;
                    this.charts.networkFlow.data.datasets[1].data = downloadSpeeds;
                    this.charts.networkFlow.update('none');
                }
            }

            updateThreatFeed(threats) {
                const threatFeed = document.getElementById('threatFeed');
                const threatCount = document.getElementById('threatCount');
                
                threatCount.textContent = `${threats ? threats.length : 0} active threats`;
                
                if (!threats || threats.length === 0) {
                    threatFeed.innerHTML = `
                        <div class="threat-item low">
                            <div class="threat-header">
                                <div class="threat-title">No Active Threats</div>
                                <div class="threat-time">${new Date().toLocaleTimeString()}</div>
                            </div>
                            <div class="threat-details">
                                <div class="threat-detail">
                                    <div class="detail-label">Status</div>
                                    <div class="detail-value">All Systems Secure</div>
                                </div>
                                <div class="threat-detail">
                                    <div class="detail-label">Confidence</div>
                                    <div class="detail-value">100%</div>
                                </div>
                            </div>
                        </div>
                    `;
                    return;
                }

                threatFeed.innerHTML = threats.map(threat => `
                    <div class="threat-item ${threat.severity.toLowerCase()}">
                        <div class="threat-header">
                            <div class="threat-title">${threat.type}</div>
                            <div class="threat-time">${threat.timestamp}</div>
                        </div>
                        <div class="threat-details">
                            <div class="threat-detail">
                                <div class="detail-label">Source IP</div>
                                <div class="detail-value">${threat.source_ip}</div>
                            </div>
                            <div class="threat-detail">
                                <div class="detail-label">Destination</div>
                                <div class="detail-value">${threat.destination_ip}</div>
                            </div>
                            <div class="threat-detail">
                                <div class="detail-label">Confidence</div>
                                <div class="detail-value">${(threat.confidence * 100).toFixed(1)}%</div>
                            </div>
                            <div class="threat-detail">
                                <div class="detail-label">AI Model</div>
                                <div class="detail-value">${threat.ai_model || 'Behavioral Analysis'}</div>
                            </div>
                        </div>
                    </div>
                `).join('');
            }

            updateGlobalThreatMap(threats) {
                const mapContainer = document.getElementById('globalThreatMap');
                
                // Clear existing points
                this.threatPoints.forEach(point => point.element.remove());
                this.threatPoints = [];

                // Add new points with enhanced visualization
                threats.forEach(threat => {
                    if (threat.severity === 'low') return;

                    const point = document.createElement('div');
                    point.className = `map-point ${threat.severity}`;
                    point.threatData = threat;

                    // Realistic geographic distribution
                    const coords = this.getGeographicCoordinates(threat.source_ip);
                    point.style.left = `${coords.x}%`;
                    point.style.top = `${coords.y}%`;

                    // Add enhanced tooltip
                    point.addEventListener('mouseenter', (e) => this.showTooltip(e, threat));
                    point.addEventListener('mouseleave', () => this.hideTooltip());

                    mapContainer.appendChild(point);
                    this.threatPoints.push({ element: point, threat: threat });
                });
            }

            getGeographicCoordinates(ip) {
                // Simplified geographic mapping based on IP patterns
                const hash = this.hashString(ip);
                return {
                    x: 10 + (hash % 80),
                    y: 10 + ((hash * 7) % 80)
                };
            }

            hashString(str) {
                let hash = 0;
                for (let i = 0; i < str.length; i++) {
                    hash = ((hash << 5) - hash) + str.charCodeAt(i);
                    hash |= 0;
                }
                return Math.abs(hash);
            }

            showTooltip(event, threat) {
                this.hideTooltip();
                
                const tooltip = document.createElement('div');
                tooltip.className = 'tooltip';
                tooltip.innerHTML = `
                    <strong>${threat.type}</strong><br>
                    Source: ${threat.source_ip}<br>
                    Confidence: ${(threat.confidence * 100).toFixed(1)}%<br>
                    Action: ${threat.response_action || 'Monitoring'}
                `;
                tooltip.style.left = (event.pageX + 10) + 'px';
                tooltip.style.top = (event.pageY + 10) + 'px';
                tooltip.style.opacity = '1';

                document.body.appendChild(tooltip);
                this.currentTooltip = tooltip;
            }

            hideTooltip() {
                if (this.currentTooltip) {
                    this.currentTooltip.remove();
                    this.currentTooltip = null;
                }
            }

            updateTrends(data) {
                // Calculate trends based on previous data
                const trends = {
                    threat: this.calculateTrend('active_incidents', data.active_incidents),
                    confidence: this.calculateTrend('ai_confidence', data.ai_confidence),
                    health: this.calculateTrend('system_health', data.system_health),
                    prevention: this.calculateTrend('threat_prevention_rate', data.threat_prevention_rate),
                    optimization: this.calculateTrend('optimization_score', data.optimization_score),
                    performance: this.calculateTrend('performance_boost', data.performance_boost)
                };

                // Update trend indicators
                this.updateTrendElement('threatTrend', trends.threat);
                this.updateTrendElement('confidenceTrend', trends.confidence);
                this.updateTrendElement('healthTrend', trends.health);
                this.updateTrendElement('preventionTrend', trends.prevention);
                this.updateTrendElement('optimizationTrend', trends.optimization);
                this.updateTrendElement('performanceTrend', trends.performance);

                this.previousData = data;
            }

            calculateTrend(key, currentValue) {
                if (!this.previousData[key]) return { direction: 'up', value: 0 };
                
                const previous = this.previousData[key];
                const change = ((currentValue - previous) / previous) * 100;
                
                return {
                    direction: change >= 0 ? 'up' : 'down',
                    value: Math.abs(change).toFixed(1)
                };
            }

            updateTrendElement(elementId, trend) {
                const element = document.getElementById(elementId);
                element.innerHTML = `
                    <i class="fas fa-arrow-${trend.direction}"></i> ${trend.value}%
                `;
                element.className = `stat-trend trend-${trend.direction}`;
            }

            updateUIElements(data) {
                // Update timestamps
                const now = new Date();
                document.getElementById('timelineUpdate').textContent = `Updated ${now.toLocaleTimeString()}`;
                document.getElementById('networkUpdate').textContent = `Active - ${data.active_connections || 0} connections`;
                
                // Update security badges based on threat level
                this.updateSecurityStatus(data.active_incidents || 0);
            }

            updateSecurityStatus(threatCount) {
                const threatBadge = document.querySelector('.stat-card.critical .security-badge');
                
                if (threatCount === 0) {
                    threatBadge.className = 'security-badge badge-success';
                    threatBadge.innerHTML = '<i class="fas fa-check-circle"></i> SECURE';
                } else if (threatCount <= 2) {
                    threatBadge.className = 'security-badge badge-warning';
                    threatBadge.innerHTML = '<i class="fas fa-shield-alt"></i> WARNING';
                } else {
                    threatBadge.className = 'security-badge badge-danger';
                    threatBadge.innerHTML = '<i class="fas fa-shield-alt"></i> CRITICAL';
                }
            }

            // Enhanced API methods with better error handling
            async startAITraining() {
                const btn = event.target;
                const originalText = btn.innerHTML;
                
                try {
                    btn.innerHTML = '<i class="fas fa-sync fa-spin"></i> Training AI...';
                    btn.disabled = true;

                    const response = await fetch('/api/start-ai-training', {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json',
                        }
                    });

                    if (!response.ok) throw new Error('Training failed');

                    const result = await response.json();
                    this.showNotification('AI Training initiated successfully', 'success');
                    
                    // Update UI with training results
                    if (result.training_data) {
                        this.updateAITrainingResults(result.training_data);
                    }

                } catch (error) {
                    this.showNotification('AI Training failed: ' + error.message, 'error');
                } finally {
                    setTimeout(() => {
                        btn.innerHTML = originalText;
                        btn.disabled = false;
                    }, 2000);
                }
            }

            showNotification(message, type) {
                const notification = document.createElement('div');
                notification.className = `security-notification ${type}`;
                notification.innerHTML = `
                    <i class="fas fa-${type === 'success' ? 'check-circle' : 'exclamation-triangle'}"></i>
                    <span>${message}</span>
                `;

                document.body.appendChild(notification);

                // Animate in
                setTimeout(() => notification.style.transform = 'translateX(0)', 100);

                // Auto remove
                setTimeout(() => {
                    notification.style.transform = 'translateX(100%)';
                    setTimeout(() => notification.remove(), 300);
                }, 5000);
            }

            // Enhanced data generation for demo
            generateMockData() {
                const now = new Date();
                const mockThreats = [
                    {
                        id: `threat_${Date.now()}_1`,
                        timestamp: now.toLocaleTimeString(),
                        type: 'Port Scan',
                        severity: 'MEDIUM',
                        source_ip: `192.168.${Math.floor(Math.random() * 255)}.${Math.floor(Math.random() * 255)}`,
                        destination_ip: `10.0.${Math.floor(Math.random() * 255)}.${Math.floor(Math.random() * 255)}`,
                        confidence: 0.85,
                        status: 'DETECTED',
                        ai_model: 'Isolation Forest'
                    },
                    {
                        id: `threat_${Date.now()}_2`,
                        timestamp: new Date(now.getTime() - 30000).toLocaleTimeString(),
                        type: 'Suspicious Login',
                        severity: 'HIGH',
                        source_ip: `203.0.${Math.floor(Math.random() * 255)}.${Math.floor(Math.random() * 255)}`,
                        destination_ip: `10.0.${Math.floor(Math.random() * 255)}.${Math.floor(Math.random() * 255)}`,
                        confidence: 0.92,
                        status: 'BLOCKED',
                        ai_model: 'Behavioral Analysis'
                    }
                ];

                return {
                    active_incidents: Math.floor(Math.random() * 5),
                    ai_confidence: 85 + Math.random() * 10,
                    system_health: 80 + Math.random() * 15,
                    threat_prevention_rate: 90 + Math.random() * 8,
                    optimization_score: 75 + Math.random() * 20,
                    performance_boost: 40 + Math.random() * 20,
                    active_connections: 50 + Math.floor(Math.random() * 150),
                    threat_feed: mockThreats,
                    charts: {
                        timeline: {
                            threats: Array.from({length: 24}, () => Math.floor(Math.random() * 20))
                        },
                        threat_categories: [
                            Math.floor(Math.random() * 20) + 5,
                            Math.floor(Math.random() * 15) + 3,
                            Math.floor(Math.random() * 12) + 2,
                            Math.floor(Math.random() * 8) + 1,
                            Math.floor(Math.random() * 18) + 4
                        ],
                        performance: [
                            80 + Math.random() * 15,
                            75 + Math.random() * 20,
                            85 + Math.random() * 10,
                            90 + Math.random() * 8,
                            88 + Math.random() * 10,
                            92 + Math.random() * 6
                        ],
                        ai_models_comparison: [
                            90 + Math.random() * 8,
                            85 + Math.random() * 10,
                            95 + Math.random() * 4
                        ]
                    },
                    real_network_stats: {
                        bytes_sent_per_sec: Math.random() * 1000000,
                        bytes_recv_per_sec: Math.random() * 1500000
                    },
                    network_metrics: Array.from({length: 12}, () => ({
                        bytes_sent_per_sec: Math.random() * 1000000,
                        bytes_recv_per_sec: Math.random() * 1500000
                    }))
                };
            }

            destroy() {
                if (this.updateInterval) {
                    clearInterval(this.updateInterval);
                }
                Object.values(this.charts).forEach(chart => chart.destroy());
            }
        }

        // Initialize the enhanced dashboard
        document.addEventListener('DOMContentLoaded', function() {
            window.securityDashboard = new SecurityDashboard();
            window.securityDashboard.initialize();
        });

        // Global functions for button handlers
        async function startAITraining() {
            await window.securityDashboard.startAITraining();
        }

        async function optimizeSystem() {
            const btn = event.target;
            const originalText = btn.innerHTML;
            
            try {
                btn.innerHTML = '<i class="fas fa-sync fa-spin"></i> Optimizing...';
                btn.disabled = true;

                const response = await fetch('/api/optimize-system', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    }
                });

                if (!response.ok) throw new Error('Optimization failed');

                const result = await response.json();
                window.securityDashboard.showNotification('System optimization completed', 'success');

            } catch (error) {
                window.securityDashboard.showNotification('Optimization failed: ' + error.message, 'error');
            } finally {
                setTimeout(() => {
                    btn.innerHTML = originalText;
                    btn.disabled = false;
                }, 2000);
            }
        }

        async function clearThreats() {
            if (!confirm('Are you sure you want to clear all threat history? This action cannot be undone.')) {
                return;
            }

            const btn = event.target;
            const originalText = btn.innerHTML;
            
            try {
                btn.innerHTML = '<i class="fas fa-sync fa-spin"></i> Clearing...';
                btn.disabled = true;

                const response = await fetch('/api/clear-threats', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    }
                });

                if (!response.ok) throw new Error('Clear operation failed');

                window.securityDashboard.showNotification('All threats cleared successfully', 'success');
                window.securityDashboard.fetchRealTimeData(); // Refresh data

            } catch (error) {
                window.securityDashboard.showNotification('Failed to clear threats: ' + error.message, 'error');
            } finally {
                setTimeout(() => {
                    btn.innerHTML = originalText;
                    btn.disabled = false;
                }, 2000);
            }
        }

        async function scanNetwork() {
            const btn = event.target;
            const originalText = btn.innerHTML;
            
            try {
                btn.innerHTML = '<i class="fas fa-sync fa-spin"></i> Scanning...';
                btn.disabled = true;

                const response = await fetch('/api/network/devices');
                if (!response.ok) throw new Error('Scan failed');

                const result = await response.json();
                window.securityDashboard.showNotification(`Found ${result.devices?.length || 0} network devices`, 'success');

            } catch (error) {
                window.securityDashboard.showNotification('Network scan failed: ' + error.message, 'error');
            } finally {
                setTimeout(() => {
                    btn.innerHTML = originalText;
                    btn.disabled = false;
                }, 2000);
            }
        }

        async function logout() {
            try {
                await fetch('/api/auth/logout', { 
                    method: 'POST'
                });
                window.location.href = '/auth';
            } catch (error) {
                console.error('Error logging out:', error);
                window.location.href = '/auth';
            }
        }
    </script>
</body>
</html>